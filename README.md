<div align="center">

# **Chunking Subnet on Bittensor** <!-- omit in toc -->

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT) 

---

## Leading the way for better NLP <!-- omit in toc -->

[Discord](https://discord.gg/bittensor) • [Network](https://taostats.io/) • [Research](https://bittensor.com/whitepaper)
</div>

## Introduction

### Description

[Chunking](./docs/chunking.md) is a critical aspect of preprocessing data when using vector database solutions. By refining and optimizing chunking techniques, we aim to enhance the efficiency and effectiveness of Retrieval-Augmented Generation (RAG) systems. 

**Frontends**

To make use of the subnet, see our frontend:

- [chunking.com](https://chunking.com)


## Getting Started

- Review min compute requirements for desired role

- Ensure you've gone through the [checklist for validating and mining](https://docs.bittensor.com/subnets/checklist-for-validating-mining)

### Computation Requirements
- To run a validator, there are no specific computation requirements as all major computer architectures are optimized for vector operations. We recommend you run the test_compute_requirements script to get a recommendation for the number of embeddings you should compute for each miner evaluation.

- To run a miner, again there are no specific computation requirements as the amount of compute is entirely dependent on the code you are running. The default miner we provide should run on any hardware.

### Installation

#### Validating

Please see [Validator Setup](./docs/validator_setup.md) to learn how to set up a validator

#### Miner

Please see [Miner Setup](./docs/miner_setup.md) to learn how to set up a miner

## Ranking

Validators maintain an internal ranking of all miners which they use to decide which miners to query and what weights to set. When choosing which miners to query, validators create groups of miners with adjacent ranks. They then choose one of these groups at random and query all of the miners in that group. Once all the miners' responses have been scored, the validator then ranks them relative to each other and adjusts these rankings to reflect their overall rankings. For organic queries, groups are created to include the miners specified by the user.

Here is an example of this system with 12 miners and a sample size of 4:
![ranking_visualization](./assets/ranking_visualization.png)

### Incentive Curve
When setting weights, the weight of the nth-best ranked miner will be twice that of the weight of the (n+1)th ranked miner. This makes it so that for anyone running a miner, improving that miner's rank by one spot will always result in more emissions than running more miners.

Here is an example of the incentive curve with 5 miners:
![incentive_curve](./assets/incentive_curve.png)


## Evaluating

As described in more detail in the validator and mining setup documentation, validators need to consider the number of embeddings they will generate while evaluating a miner. When scoring, a random-sample of 3-sentence segments are taken from the response and are embedded. The dot product of every possible pair of these embeddings is then compared and added to the final score. If the embeddings originated from the same chunk, it is added to the final score if the embeddings originated from different chunks, it is subtracted from the final score.

Here is a visualization of how the validator calculates the miner’s score:
![evaluations](./assets/evaluations.png)

A greater sample size will likely result in more accurate evaluations and higher yields. This will come at the cost of more API calls to generate the additional embeddings and potentially more time and resources comparing them against each other. 

If the chunks generated by the miner have more tokens than specified by the validator, their score is penalized exponentially per token above the limit.

## Resources

For miners, there are various approaches to chunking that can produce high-quality chunks. We recommend that you use recursive or semantic chunking, but in line with Bittensor’s ideology, we invite you to experiment. To learn more about the basics of chunking, we recommend you read through this [article](https://www.pinecone.io/learn/chunking-strategies/). Additional resources are provided in the [Miner Setup](./docs/miner_setup.md) documentation.

